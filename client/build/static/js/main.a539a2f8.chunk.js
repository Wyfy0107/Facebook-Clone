(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,n){},129:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(88),i=n.n(c),l=n(7),o=(n(100),n(14)),u=n(11),s=n(33),m=n.n(s),d=n(30),f=n(15),b=n(18);function p(){var e=Object(u.a)(["\n  position: relative;\n  top: 3rem;\n"]);return p=function(){return e},e}function E(){var e=Object(u.a)(["\n  border-radius: 6px;\n  outline: none;\n  height: 3rem;\n  width: 15rem;\n"]);return E=function(){return e},e}var v=f.a.input(E()),O=f.a.div(p());var j=function(e){var t=e.setAuth,n=Object(a.useState)(null),c=Object(l.a)(n,2),i=c[0],o=c[1],u=Object(a.useState)(null),s=Object(l.a)(u,2),f=s[0],p=s[1];return r.a.createElement(O,null,r.a.createElement("h1",null,"Login"),r.a.createElement(v,{type:"text",placeholder:"email",onChange:function(e){return o(e.target.value)}}),r.a.createElement("br",null),r.a.createElement(v,{type:"password",placeholder:"password",onChange:function(e){return p(e.target.value)}}),r.a.createElement("br",null),r.a.createElement(b.a,{style:{margin:"5px"},onClick:function(){if(!i&&!f)return alert("please fill in email and password");m.a.post("/login",{email:i,password:f}).then((function(e){"success"===e.data&&t(!0)})).catch((function(e){return console.log(e)}))}},"Login"),r.a.createElement("br",null),r.a.createElement(d.b,{to:"/register"},"Register"))};function h(){var e=Object(u.a)(["\n  border-radius: 6px;\n  outline: none;\n  height: 3rem;\n  width: 15rem;\n"]);return h=function(){return e},e}function g(){var e=Object(u.a)(["\n  position: relative;\n  top: 3rem;\n"]);return g=function(){return e},e}var y=f.a.div(g()),w=f.a.input(h());var k=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(null),u=Object(l.a)(i,2),s=u[0],f=u[1],p=Object(a.useState)(!1),E=Object(l.a)(p,2),v=E[0],O=E[1];return v?r.a.createElement(o.a,{to:"/"}):r.a.createElement(y,null,r.a.createElement("h1",null,"Register"),r.a.createElement(w,{type:"text",placeholder:"email",onChange:function(e){return c(e.target.value)}}),r.a.createElement("br",null),r.a.createElement(w,{type:"password",placeholder:"password",onChange:function(e){return f(e.target.value)}}),r.a.createElement("br",null),r.a.createElement(b.a,{style:{margin:"5px"},onClick:function(){if(!n&&!s)return alert("please fill in email and password");m.a.post("/register",{email:n,password:s}).then((function(e){alert("success"),O(!0)})).catch((function(e){return alert(e.message)}))}},"Register"),r.a.createElement("br",null),r.a.createElement(d.b,{to:"/"},"Login"))},S=n(6);function x(){var e=Object(u.a)(["\n  subscription POST_SUBSCRIPTION {\n    newPostAdded {\n      __typename\n      id\n      content\n    }\n  }\n"]);return x=function(){return e},e}function C(){var e=Object(u.a)(["\n  mutation UPDATE_LIKE($id: String, $amount: Int) {\n    updateLike(id: $id, amount: $amount) {\n      id\n    }\n  }\n"]);return C=function(){return e},e}function L(){var e=Object(u.a)(["\n  mutation ADD_COMMENT($id: String, $email: String, $comment: String) {\n    addComment(id: $id, email: $email, comment: $comment) {\n      email\n      comment\n    }\n  }\n"]);return L=function(){return e},e}function P(){var e=Object(u.a)(["\n  mutation DELETE_POST($id: String) {\n    deletePost(id: $id) {\n      id\n    }\n  }\n"]);return P=function(){return e},e}function $(){var e=Object(u.a)(["\n  mutation addPost($email: String, $content: String) {\n    addPost(email: $email, content: $content) {\n      id\n    }\n  }\n"]);return $=function(){return e},e}function A(){var e=Object(u.a)(["\n  query GET_LIKE($id: String) {\n    likes(id: $id) {\n      likes\n    }\n  }\n"]);return A=function(){return e},e}function q(){var e=Object(u.a)(["\n  query GET_COMMENT($id: String) {\n    commentList(id: $id) {\n      commentList {\n        email\n        comment\n      }\n    }\n  }\n"]);return q=function(){return e},e}function I(){var e=Object(u.a)(["\n  query GET_ALL_POSTS {\n    posts {\n      id\n      email\n      content\n    }\n  }\n"]);return I=function(){return e},e}function T(){var e=Object(u.a)(["\n  query User($email: String) {\n    user(email: $email) {\n      email\n      posts {\n        id\n        content\n      }\n    }\n  }\n"]);return T=function(){return e},e}var M=Object(S.gql)(T()),_=Object(S.gql)(I()),z=Object(S.gql)(q()),D=Object(S.gql)(A()),N=Object(S.gql)($()),F=Object(S.gql)(P()),Q=Object(S.gql)(L()),R=Object(S.gql)(C()),G=Object(S.gql)(x()),K=n(36);function U(){var e=Object(u.a)(["\n  width: 50%;\n  margin: auto;\n"]);return U=function(){return e},e}function B(){var e=Object(u.a)(["\n  margin: 5px;\n  background: #3a3b3c;\n  border-radius: 10px;\n"]);return B=function(){return e},e}function J(){var e=Object(u.a)(["\n  display: flex;\n  flex-flow: column;\n"]);return J=function(){return e},e}var H=f.a.div(J()),V=f.a.div(B()),W=f.a.input(U());var X=function(e){var t=e.commentList,n=e.postId,c=Object(a.useState)(null),i=Object(l.a)(c,2),o=i[0],u=i[1],s=Object(a.useState)(null),d=Object(l.a)(s,2),f=d[0],p=d[1],E=Object(a.useState)(null),v=Object(l.a)(E,2),O=v[0],j=v[1],h=Object(S.useMutation)(Q),g=Object(l.a)(h,2),y=g[0],w=g[1].data;Object(a.useEffect)((function(){if(j(t),k(),w&&O){var e=Object(K.a)(O),n={email:w.addComment.email,comment:w.addComment.comment};e.push(n),j(e)}}),[f,w]);var k=function(){m.a.get("/api/profile").then((function(e){p(e.data.email)})).catch((function(e){alert("please login again")}))};return r.a.createElement(H,null,r.a.createElement("div",null,r.a.createElement(W,{type:"text",onChange:function(e){return u(e.target.value)}}),r.a.createElement(b.a,{onClick:function(){y({variables:{id:n,email:f,comment:o},fetchPolicy:"no-cache"})},size:"sm",style:{margin:"5px"}},"Add")),O&&O.map((function(e,t){return r.a.createElement(V,{key:t},e.email,r.a.createElement("br",null),e.comment)})))};function Y(){var e=Object(u.a)(["\n  display: flex;\n  flex-flow: column;\n  background: #242526;\n  width: 32vw;\n  margin: 1rem auto 1rem;\n  border-radius: 10px;\n  padding: 5px;\n"]);return Y=function(){return e},e}var Z=f.a.div(Y());var ee=function(e){var t=e.post,n=Object(a.useState)(0),c=Object(l.a)(n,2),i=c[0],o=c[1],u=Object(a.useState)(null),s=Object(l.a)(u,2),m=s[0],d=s[1],f=Object(a.useState)(!1),p=Object(l.a)(f,2),E=p[0],v=p[1],O=Object(S.useQuery)(D,{variables:{id:t.id},fetchPolicy:"no-cache"}).data,j=Object(S.useQuery)(z,{variables:{id:t.id},fetchPolicy:"no-cache"}).data,h=Object(S.useMutation)(R),g=Object(l.a)(h,1)[0];return Object(a.useEffect)((function(){O&&o(O.likes[0].likes),j&&j.commentList&&d(j.commentList.commentList)}),[O,j]),r.a.createElement("div",null,r.a.createElement(Z,{key:t.id},r.a.createElement("h4",null,t.email),r.a.createElement("p",null,t.content),r.a.createElement("div",{style:{display:"flex",flexFlow:"row",justifyContent:"space-between"}},r.a.createElement(b.a,{size:"sm",style:{width:"20%"},onClick:function(){o(i+1,g({variables:{id:t.id,amount:i+1}}))}},"Like"),r.a.createElement("p",null,i," likes"),r.a.createElement(b.a,{size:"sm",style:{width:"20%"},onClick:function(){return v(!E)}},"Comments")),r.a.createElement("div",{style:{display:E?"block":"none"}},r.a.createElement("hr",{style:{backgroundColor:"white",width:"80%"}}),r.a.createElement(X,{postId:t.id,commentList:m,style:{height:"100%"}}))))};var te=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],c=t[1],i=Object(S.useQuery)(_,{fetchPolicy:"no-cache"}),o=i.data,u=i.error,s=i.loading;return Object(a.useEffect)((function(){o&&c(o.posts)}),[o]),u&&console.log(u),s?r.a.createElement("p",null,"Loading..."):r.a.createElement("div",{style:{marginTop:"3rem"}},n&&n.map((function(e){return r.a.createElement(ee,{key:e.id,post:e})})))};function ne(){var e=Object(u.a)(["\n  display: flex;\n  flex-flow: column;\n  background: #242526;\n  width: 25vw;\n  margin: 1rem auto 1rem;\n  border-radius: 10px;\n  padding: 5px;\n"]);return ne=function(){return e},e}var ae=f.a.div(ne());var re=function(e){var t=e.post,n=e.posts,c=e.email,i=e.setPosts,o=Object(S.useMutation)(F),u=Object(l.a)(o,1)[0],s=Object(S.useQuery)(D,{variables:{id:t.id},fetchPolicy:"no-cache"}).data,m=Object(S.useMutation)(R),d=Object(l.a)(m,1)[0],f=Object(a.useState)(0),p=Object(l.a)(f,2),E=p[0],v=p[1];return Object(a.useEffect)((function(){s&&0!==s.likes.length&&v(s.likes[0].likes)}),[s]),r.a.createElement("div",null,r.a.createElement(ae,{key:t.id},r.a.createElement("h4",null,c),r.a.createElement("p",null,t.content),r.a.createElement("div",{style:{display:"flex",flexFlow:"row",justifyContent:"space-between"}},r.a.createElement(b.a,{size:"sm",style:{width:"20%"},onClick:function(){v(E+1,d({variables:{id:t.id,amount:E+1}}))}},"Like"),r.a.createElement("p",null,E," likes"),r.a.createElement(b.a,{size:"sm",style:{width:"20%"},onClick:function(){u({variables:{id:t.id},fetchPolicy:"no-cache"}),function(e){var t=Object(K.a)(n),a=t.findIndex((function(t){return t.id===e}));t.splice(a,1),i(t)}(t.id)}},"Delete"))))};var ce=function(e){var t=e.email,n=e.data,c=Object(a.useState)(null),i=Object(l.a)(c,2),o=i[0],u=i[1],s=Object(S.useSubscription)(G).data;return Object(a.useEffect)((function(){if(n){var e=n.user,t=Object(K.a)(e[0].posts);u(t)}if(s){var a=Object(K.a)(o);a.push(s.newPostAdded),u(a)}}),[n,s]),r.a.createElement("div",null,o&&o.map((function(e){return r.a.createElement(re,{key:e.id,post:e,email:t,setPosts:u,posts:o})})))};function ie(){var e=Object(u.a)(["\n  border-radius: 10px;\n  outline: none;\n  width: 15rem;\n  height: 3rem;\n  margin: 0.5rem;\n"]);return ie=function(){return e},e}function le(){var e=Object(u.a)(["\n  background: #242526;\n  width: 30vw;\n  margin: auto;\n  position: relative;\n  top: 2rem;\n  border-radius: 10px;\n  padding: 0.5rem;\n"]);return le=function(){return e},e}var oe=f.a.div(le()),ue=f.a.input(ie());var se=function(e){var t=e.setAuth,n=Object(a.useState)(null),c=Object(l.a)(n,2),i=c[0],o=c[1],u=Object(a.useState)(null),s=Object(l.a)(u,2),d=s[0],f=s[1],p=Object(S.useLazyQuery)(M),E=Object(l.a)(p,2),v=E[0],O=E[1],j=O.loading,h=O.error,g=O.data,y=Object(S.useMutation)(N),w=Object(l.a)(y,1)[0];Object(a.useEffect)((function(){k(),i&&v({variables:{email:i},fetchPolicy:"no-cache"})}),[i]);var k=function(){m.a.get("/api/profile").then((function(e){o(e.data.email)})).catch((function(e){t(!1),alert("please login again")}))};return j?r.a.createElement("p",null,"Loading..."):(h&&console.log(h),r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",flexFlow:"column",justifyContent:"space-around"}},r.a.createElement("div",null,r.a.createElement(oe,null,r.a.createElement(ue,{onChange:function(e){return f(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("div",{style:{display:"flex",flexFlow:"row",justifyContent:"space-around"}},r.a.createElement(b.a,{onClick:function(){d?w({variables:{email:i,content:d}}):alert("please fill posts")}},"Post"),r.a.createElement(b.a,{onClick:function(){t(!1),m.a.post("/logout").catch((function(e){return console.log(e)}))}},"Log out")))),r.a.createElement("div",{style:{position:"relative",top:"6rem"}},r.a.createElement(ce,{email:i,data:g})))))},me=n(55);var de=function(e){var t=e.setAuth;return r.a.createElement("div",null,r.a.createElement(me.a,{style:{background:"#242526",height:"8vh",alignItems:"center",fontSize:"1.3rem"},className:"justify-content-center",activeKey:"/home"},r.a.createElement(me.a.Item,null,r.a.createElement(d.b,{style:{margin:"1rem"},to:"/dashboard/newsfeed"},"NewsFeed")),r.a.createElement(me.a.Item,null,r.a.createElement(d.b,{style:{margin:"1rem"},to:"/dashboard"},"Profile"))),r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"/dashboard/newsfeed"},r.a.createElement(te,{setAuth:t})),r.a.createElement(o.b,{exact:!0,path:"/dashboard"},r.a.createElement(se,{setAuth:t}))))};var fe=function(){var e=Object(a.useState)(!0),t=Object(l.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){return i()}),[]);var i=function(){document.cookie.split("=")[1]||c(!1)};return r.a.createElement("div",{className:"App"},r.a.createElement(o.d,null,r.a.createElement(o.b,{exact:!0,path:"/"},n?r.a.createElement(o.a,{to:"/dashboard"}):r.a.createElement(j,{setAuth:c})),r.a.createElement(o.b,{path:"/dashboard"},n?r.a.createElement(de,{setAuth:c}):r.a.createElement(o.a,{to:"/"})),r.a.createElement(o.b,{path:"/register"},r.a.createElement(k,null))))},be=(n(128),n(129),n(94)),pe=n(2),Ee=new S.HttpLink({uri:"https://auth-react-graphql.herokuapp.com/"}),ve=new be.a({uri:"ws://auth-react-graphql.herokuapp.com/",options:{reconnect:!0}}),Oe=Object(S.split)((function(e){var t=e.query,n=Object(pe.p)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),ve,Ee),je=S.ApolloLink.from([Oe]),he=new S.ApolloClient({link:je,cache:new S.InMemoryCache});i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S.ApolloProvider,{client:he},r.a.createElement(d.a,null,r.a.createElement(fe,null)))),document.getElementById("root"))},95:function(e,t,n){e.exports=n(138)}},[[95,1,2]]]);
//# sourceMappingURL=main.a539a2f8.chunk.js.map